{% load static %}
{% load tailwind_tags %}
<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PatchVoting</title>
    {% tailwind_css %}
    <script defer src="{% static 'main/js/base.js' %}"></script>
  </head>

  <body class="App">
    <div class="BackgroundGlow">
      <div class="Glow1"></div>
      <div class="Glow2"></div>
      <div class="Glow3"></div>
    </div>

    <div class="AppSurface">
      {% with TFT_SLUG="tft" %}

      <header class="Topbar">
        <div class="TopbarInner">
          <!-- Left -->
          <a href="{% url 'home' %}" class="Brand">PatchVoting</a>

          <!-- Center -->
          <div class="TopbarCenter">
            <div class="GameNav">
              {% for game in navbar_games %}
                <a href="{% url 'game_detail' game.slug %}"
                  class="GameNavItem {% if active_game_slug == game.slug %}GameNavItemActive{% else %}GameNavItemIdle{% endif %}">

                  {% if game.icon %}
                    <img src="{{ game.icon.url }}" alt="{{ game.name }} icon" class="GameNavIcon">
                  {% else %}
                    <span class="GameNavIconFallback">
                      {{ game.short_name|default:game.name|slice:":2"|upper }}
                    </span>
                  {% endif %}

                  <span class="font-medium">
                    {{ game.short_name|default:game.name|truncatechars:14 }}
                  </span>
                </a>
              {% endfor %}
            </div>
          </div>


          <!-- Right -->
          <div class="flex items-center gap-2 justify-self-end">
            {% if user.is_authenticated %}
              <a class="btn btn-ghost btn-sm" href="{% url 'profile' %}">{{ user.username }}</a>
              <a class="btn btn-outline btn-sm border-white/15 hover:bg-white/5" href="{% url 'logout' %}">Logout</a>
            {% else %}
              <a class="btn btn-ghost btn-sm" href="{% url 'login' %}">Login</a>
              <a class="btn btn-primary btn-sm" href="{% url 'signup' %}">Sign up</a>
            {% endif %}
          </div>
        </div>
      </header>

      <div class="Shell">
        <aside class="NavRail">
          <nav class="Nav">
            <a href="{% url 'home' %}" class="NavItem {% if request.path == '/' %}NavItemActive{% endif %}" title="Home">
              <span class="text-lg">üè†</span>
              <span class="NavLabel">Home</span>
            </a>

            <a href="{% url 'game_list' %}" class="NavItem {% if 'games' in request.path %}NavItemActive{% endif %}" title="Games">
              <span class="text-lg">üéÆ</span>
              <span class="NavLabel">Games</span>
            </a>

            <a href="#" class="NavItem" title="Patches">
              <span class="text-lg">üß©</span>
              <span class="NavLabel">Patches</span>
            </a>

            <a href="#" class="NavItem" title="Suggestions">
              <span class="text-lg">üó≥Ô∏è</span>
              <span class="NavLabel">Suggestions</span>
            </a>

            <div class="NavSectionTitle">Current game</div>

            <a href="{% url 'game_detail' active_game_slug|default:TFT_SLUG %}"
               class="NavItem {% if active_game_slug %}NavItemActive{% endif %}"
               title="Current game">
              <span class="text-lg">‚ú®</span>
              <span class="NavLabel">{% if current_game %}{{ current_game.name }}{% else %}Teamfight Tactics{% endif %}</span>
            </a>

            <div class="NavFooter">
              {% if user.is_authenticated %}
                <a href="{% url 'profile' %}" class="NavItem {% if 'profile' in request.path %}NavItemActive{% endif %}" title="Profile">
                  <span class="text-lg">üë§</span>
                  <span class="NavLabel">Profile</span>
                </a>
              {% endif %}

              <a href="#" class="NavItem" title="Settings">
                <span class="text-lg">‚öôÔ∏è</span>
                <span class="NavLabel">Settings</span>
              </a>
            </div>
          </nav>
        </aside>

        <main class="Main">
          <div class="Container">
            {% block content %}{% endblock %}
          </div>
        </main>
      </div>

      {% endwith %}
    </div>
  </body>
</html>
